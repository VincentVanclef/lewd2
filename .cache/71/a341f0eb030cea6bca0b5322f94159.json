{"id":"AwHT","dependencies":[{"name":"C:\\Users\\inaba\\Programming\\Lewd2\\.babelrc","includedInParent":true,"mtime":1545517173655},{"name":"C:\\Users\\inaba\\Programming\\Lewd2\\package.json","includedInParent":true,"mtime":1545850952595},{"name":"../../helpers/database","loc":{"line":1,"column":26},"parent":"C:\\Users\\inaba\\Programming\\Lewd2\\src\\Controllers\\delete\\delete.js","resolved":"C:\\Users\\inaba\\Programming\\Lewd2\\src\\helpers\\database.js"},{"name":"../../Functions/FileDeletion/deleteFiles","loc":{"line":2,"column":26},"parent":"C:\\Users\\inaba\\Programming\\Lewd2\\src\\Controllers\\delete\\delete.js","resolved":"C:\\Users\\inaba\\Programming\\Lewd2\\src\\Functions\\FileDeletion\\deleteFiles.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.get=i,exports.post=n,exports.validate=void 0;var e=a(require(\"../../helpers/database\")),t=a(require(\"../../Functions/FileDeletion/deleteFiles\"));function a(e){return e&&e.__esModule?e:{default:e}}async function i(a,i){const n=a.params.key,s=await e.default.connect(),r=(await s.query('SELECT id, filename, filesha, duplicate \\n                                            FROM \"Uploads\"\\n                                            WHERE deletionkey = $1;',[n])).rows[0];if(void 0===r)return i.redirect(\"/\");await(0,t.default)([r.filename]),i.send(`${r.filename} has just been deleted`)}function n(e,t){}const s=[];exports.validate=s;","map":{"mappings":[{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":0}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":13}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":20}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":35}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":43}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":56}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":57}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":64}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":68}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":76}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":80}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":82}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":90}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":95}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":97}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":105}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":119}},{"source":"Controllers/delete/delete.js","original":{"line":1,"column":0},"generated":{"line":1,"column":121}},{"source":"Controllers/delete/delete.js","original":{"line":1,"column":0},"generated":{"line":1,"column":125}},{"source":"Controllers/delete/delete.js","original":{"line":1,"column":0},"generated":{"line":1,"column":127}},{"source":"Controllers/delete/delete.js","original":{"line":1,"column":0},"generated":{"line":1,"column":129}},{"source":"Controllers/delete/delete.js","original":{"line":1,"column":0},"generated":{"line":1,"column":137}},{"source":"Controllers/delete/delete.js","original":{"line":2,"column":0},"generated":{"line":1,"column":164}},{"source":"Controllers/delete/delete.js","original":{"line":2,"column":0},"generated":{"line":1,"column":166}},{"source":"Controllers/delete/delete.js","original":{"line":2,"column":0},"generated":{"line":1,"column":168}},{"source":"Controllers/delete/delete.js","original":{"line":2,"column":0},"generated":{"line":1,"column":176}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":221}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":230}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":232}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":235}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":242}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":245}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":247}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":258}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":260}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":261}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":269}},{"source":"Controllers/delete/delete.js","original":{"line":4,"column":0},"generated":{"line":1,"column":272}},{"source":"Controllers/delete/delete.js","name":"get","original":{"line":4,"column":15},"generated":{"line":1,"column":287}},{"source":"Controllers/delete/delete.js","name":"req","original":{"line":4,"column":19},"generated":{"line":1,"column":289}},{"source":"Controllers/delete/delete.js","name":"res","original":{"line":4,"column":24},"generated":{"line":1,"column":291}},{"source":"Controllers/delete/delete.js","name":"deletionKey","original":{"line":5,"column":10},"generated":{"line":1,"column":294}},{"source":"Controllers/delete/delete.js","name":"deletionKey","original":{"line":5,"column":10},"generated":{"line":1,"column":300}},{"source":"Controllers/delete/delete.js","name":"req","original":{"line":5,"column":24},"generated":{"line":1,"column":302}},{"source":"Controllers/delete/delete.js","name":"params","original":{"line":5,"column":28},"generated":{"line":1,"column":304}},{"source":"Controllers/delete/delete.js","name":"key","original":{"line":5,"column":35},"generated":{"line":1,"column":311}},{"source":"Controllers/delete/delete.js","name":"client","original":{"line":6,"column":10},"generated":{"line":1,"column":315}},{"source":"Controllers/delete/delete.js","name":"db","original":{"line":6,"column":25},"generated":{"line":1,"column":323}},{"source":"Controllers/delete/delete.js","name":"connect","original":{"line":6,"column":28},"generated":{"line":1,"column":325}},{"source":"Controllers/delete/delete.js","name":"connect","original":{"line":6,"column":28},"generated":{"line":1,"column":333}},{"source":"Controllers/delete/delete.js","name":"file","original":{"line":13,"column":10},"generated":{"line":1,"column":343}},{"source":"Controllers/delete/delete.js","name":"client","original":{"line":9,"column":30},"generated":{"line":1,"column":352}},{"source":"Controllers/delete/delete.js","name":"query","original":{"line":9,"column":37},"generated":{"line":1,"column":354}},{"source":"Controllers/delete/delete.js","original":{"line":9,"column":44},"generated":{"line":1,"column":360}},{"source":"Controllers/delete/delete.js","original":{"line":11,"column":70},"generated":{"line":1,"column":532}},{"source":"Controllers/delete/delete.js","name":"deletionKey","original":{"line":11,"column":71},"generated":{"line":1,"column":533}},{"source":"Controllers/delete/delete.js","name":"rows","original":{"line":13,"column":29},"generated":{"line":1,"column":538}},{"source":"Controllers/delete/delete.js","original":{"line":13,"column":34},"generated":{"line":1,"column":543}},{"source":"Controllers/delete/delete.js","name":"file","original":{"line":15,"column":8},"generated":{"line":1,"column":546}},{"source":"Controllers/delete/delete.js","name":"undefined","original":{"line":15,"column":17},"generated":{"line":1,"column":554}},{"source":"Controllers/delete/delete.js","name":"file","original":{"line":15,"column":8},"generated":{"line":1,"column":558}},{"source":"Controllers/delete/delete.js","name":"res","original":{"line":16,"column":15},"generated":{"line":1,"column":560}},{"source":"Controllers/delete/delete.js","name":"res","original":{"line":16,"column":15},"generated":{"line":1,"column":567}},{"source":"Controllers/delete/delete.js","name":"redirect","original":{"line":16,"column":19},"generated":{"line":1,"column":569}},{"source":"Controllers/delete/delete.js","original":{"line":16,"column":28},"generated":{"line":1,"column":578}},{"source":"Controllers/delete/delete.js","original":{"line":19,"column":10},"generated":{"line":1,"column":589}},{"source":"Controllers/delete/delete.js","original":{"line":19,"column":22},"generated":{"line":1,"column":591}},{"source":"Controllers/delete/delete.js","original":{"line":19,"column":22},"generated":{"line":1,"column":593}},{"source":"Controllers/delete/delete.js","original":{"line":19,"column":22},"generated":{"line":1,"column":602}},{"source":"Controllers/delete/delete.js","name":"file","original":{"line":19,"column":23},"generated":{"line":1,"column":603}},{"source":"Controllers/delete/delete.js","name":"filename","original":{"line":19,"column":28},"generated":{"line":1,"column":605}},{"source":"Controllers/delete/delete.js","name":"res","original":{"line":20,"column":4},"generated":{"line":1,"column":616}},{"source":"Controllers/delete/delete.js","name":"send","original":{"line":20,"column":8},"generated":{"line":1,"column":618}},{"source":"Controllers/delete/delete.js","name":"file","original":{"line":20,"column":16},"generated":{"line":1,"column":626}},{"source":"Controllers/delete/delete.js","name":"filename","original":{"line":20,"column":21},"generated":{"line":1,"column":628}},{"source":"Controllers/delete/delete.js","original":{"line":23,"column":0},"generated":{"line":1,"column":662}},{"source":"Controllers/delete/delete.js","name":"post","original":{"line":23,"column":9},"generated":{"line":1,"column":671}},{"source":"Controllers/delete/delete.js","name":"req","original":{"line":23,"column":14},"generated":{"line":1,"column":673}},{"source":"Controllers/delete/delete.js","name":"res","original":{"line":23,"column":19},"generated":{"line":1,"column":675}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":679}},{"source":"Controllers/delete/delete.js","name":"validate","original":{"line":27,"column":6},"generated":{"line":1,"column":685}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":17},"generated":{"line":1,"column":687}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":690}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":698}},{"source":"Controllers/delete/delete.js","original":{"line":27,"column":0},"generated":{"line":1,"column":707}}],"sources":{"Controllers/delete/delete.js":"import db            from \"../../helpers/database\";\r\nimport deleteFiles   from \"../../Functions/FileDeletion/deleteFiles\";\r\n\r\nasync function get(req, res) {\r\n    const deletionKey = req.params.key;\r\n    const client = await db.connect();\r\n\r\n    // Find the file to be deleted\r\n    const getFileData = await client.query(`SELECT id, filename, filesha, duplicate \r\n                                            FROM \"Uploads\"\r\n                                            WHERE deletionkey = $1;`, [deletionKey]);\r\n\r\n    const file = getFileData.rows[0];\r\n    // Do nothing if there is no file\r\n    if (file === undefined) {\r\n        return res.redirect(\"/\");\r\n    }\r\n\r\n    await deleteFiles([file.filename]);\r\n    res.send(`${file.filename} has just been deleted`);\r\n}\r\n\r\nfunction post(req, res) {\r\n\r\n}\r\n\r\nconst validate = [\r\n\r\n]\r\n\r\nexport { get, post, validate }"},"lineCount":null}},"hash":"09e874601f6573befb4ea4dc8207b285","cacheData":{"env":{}}}