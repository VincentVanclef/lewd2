{"id":"hr17","dependencies":[{"name":"C:\\Users\\inaba\\Programming\\Lewd2\\.babelrc","includedInParent":true,"mtime":1545517173655},{"name":"C:\\Users\\inaba\\Programming\\Lewd2\\package.json","includedInParent":true,"mtime":1545850952595},{"name":"../../helpers/database","loc":{"line":1,"column":15},"parent":"C:\\Users\\inaba\\Programming\\Lewd2\\src\\Functions\\User\\getUserDetails.js","resolved":"C:\\Users\\inaba\\Programming\\Lewd2\\src\\helpers\\database.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=void 0;var e=s(require(\"../../helpers/database\"));function s(e){return e&&e.__esModule?e:{default:e}}const r=async s=>{let r=0;const t=await e.default.connect(),a=await e.default.query('SELECT userid FROM \"LoginTokens\" WHERE token = $1 LIMIT 1;',[s]);a.rows[0]&&(r=a.rows[0].userid);const n=await t.query('SELECT \"Users\".id, \"Users\".username, \"Users\".token, \"Users\".roleid, \"Users\".uploadsize, \"Users\".isadmin\\n                                        FROM \"Users\"\\n                                        WHERE \"Users\".id = $1',[r]);return await t.release(),\"null\"===n.rows[0].username&&(n.rows[0].username=null),n.rows[0]};var t=r;exports.default=t;","map":{"mappings":[{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":0}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":13}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":20}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":35}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":43}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":56}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":57}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":64}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":68}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":76}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":89}},{"source":"Functions/User/getUserDetails.js","original":{"line":1,"column":0},"generated":{"line":1,"column":91}},{"source":"Functions/User/getUserDetails.js","original":{"line":1,"column":0},"generated":{"line":1,"column":95}},{"source":"Functions/User/getUserDetails.js","original":{"line":1,"column":0},"generated":{"line":1,"column":97}},{"source":"Functions/User/getUserDetails.js","original":{"line":1,"column":0},"generated":{"line":1,"column":99}},{"source":"Functions/User/getUserDetails.js","original":{"line":1,"column":0},"generated":{"line":1,"column":107}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":134}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":143}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":145}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":148}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":155}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":158}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":160}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":171}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":173}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":174}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":182}},{"source":"Functions/User/getUserDetails.js","original":{"line":7,"column":0},"generated":{"line":1,"column":185}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":7,"column":6},"generated":{"line":1,"column":191}},{"source":"Functions/User/getUserDetails.js","original":{"line":7,"column":23},"generated":{"line":1,"column":193}},{"source":"Functions/User/getUserDetails.js","original":{"line":7,"column":23},"generated":{"line":1,"column":199}},{"source":"Functions/User/getUserDetails.js","name":"userId","original":{"line":8,"column":8},"generated":{"line":1,"column":203}},{"source":"Functions/User/getUserDetails.js","name":"userId","original":{"line":8,"column":8},"generated":{"line":1,"column":207}},{"source":"Functions/User/getUserDetails.js","original":{"line":8,"column":17},"generated":{"line":1,"column":209}},{"source":"Functions/User/getUserDetails.js","name":"client","original":{"line":10,"column":10},"generated":{"line":1,"column":211}},{"source":"Functions/User/getUserDetails.js","name":"client","original":{"line":10,"column":10},"generated":{"line":1,"column":217}},{"source":"Functions/User/getUserDetails.js","name":"db","original":{"line":10,"column":26},"generated":{"line":1,"column":225}},{"source":"Functions/User/getUserDetails.js","name":"connect","original":{"line":10,"column":29},"generated":{"line":1,"column":227}},{"source":"Functions/User/getUserDetails.js","name":"connect","original":{"line":10,"column":29},"generated":{"line":1,"column":235}},{"source":"Functions/User/getUserDetails.js","name":"loginTokenCheck","original":{"line":12,"column":10},"generated":{"line":1,"column":245}},{"source":"Functions/User/getUserDetails.js","name":"db","original":{"line":12,"column":34},"generated":{"line":1,"column":253}},{"source":"Functions/User/getUserDetails.js","name":"query","original":{"line":12,"column":37},"generated":{"line":1,"column":255}},{"source":"Functions/User/getUserDetails.js","name":"query","original":{"line":12,"column":37},"generated":{"line":1,"column":263}},{"source":"Functions/User/getUserDetails.js","original":{"line":12,"column":44},"generated":{"line":1,"column":269}},{"source":"Functions/User/getUserDetails.js","original":{"line":12,"column":105},"generated":{"line":1,"column":330}},{"source":"Functions/User/getUserDetails.js","name":"loginToken","original":{"line":12,"column":106},"generated":{"line":1,"column":331}},{"source":"Functions/User/getUserDetails.js","name":"loginTokenCheck","original":{"line":14,"column":8},"generated":{"line":1,"column":335}},{"source":"Functions/User/getUserDetails.js","name":"rows","original":{"line":14,"column":24},"generated":{"line":1,"column":337}},{"source":"Functions/User/getUserDetails.js","original":{"line":14,"column":29},"generated":{"line":1,"column":342}},{"source":"Functions/User/getUserDetails.js","name":"userId","original":{"line":15,"column":8},"generated":{"line":1,"column":347}},{"source":"Functions/User/getUserDetails.js","name":"loginTokenCheck","original":{"line":15,"column":17},"generated":{"line":1,"column":349}},{"source":"Functions/User/getUserDetails.js","name":"rows","original":{"line":15,"column":33},"generated":{"line":1,"column":351}},{"source":"Functions/User/getUserDetails.js","original":{"line":15,"column":38},"generated":{"line":1,"column":356}},{"source":"Functions/User/getUserDetails.js","name":"userid","original":{"line":15,"column":41},"generated":{"line":1,"column":359}},{"source":"Functions/User/getUserDetails.js","name":"getUser","original":{"line":19,"column":10},"generated":{"line":1,"column":367}},{"source":"Functions/User/getUserDetails.js","name":"getUser","original":{"line":19,"column":10},"generated":{"line":1,"column":373}},{"source":"Functions/User/getUserDetails.js","name":"client","original":{"line":19,"column":26},"generated":{"line":1,"column":381}},{"source":"Functions/User/getUserDetails.js","name":"query","original":{"line":19,"column":33},"generated":{"line":1,"column":383}},{"source":"Functions/User/getUserDetails.js","original":{"line":19,"column":40},"generated":{"line":1,"column":389}},{"source":"Functions/User/getUserDetails.js","original":{"line":21,"column":64},"generated":{"line":1,"column":612}},{"source":"Functions/User/getUserDetails.js","name":"userId","original":{"line":22,"column":44},"generated":{"line":1,"column":613}},{"source":"Functions/User/getUserDetails.js","name":"getUser","original":{"line":29,"column":11},"generated":{"line":1,"column":617}},{"source":"Functions/User/getUserDetails.js","name":"client","original":{"line":24,"column":26},"generated":{"line":1,"column":630}},{"source":"Functions/User/getUserDetails.js","name":"release","original":{"line":24,"column":33},"generated":{"line":1,"column":632}},{"source":"Functions/User/getUserDetails.js","original":{"line":26,"column":37},"generated":{"line":1,"column":642}},{"source":"Functions/User/getUserDetails.js","name":"getUser","original":{"line":26,"column":8},"generated":{"line":1,"column":651}},{"source":"Functions/User/getUserDetails.js","name":"rows","original":{"line":26,"column":16},"generated":{"line":1,"column":653}},{"source":"Functions/User/getUserDetails.js","original":{"line":26,"column":21},"generated":{"line":1,"column":658}},{"source":"Functions/User/getUserDetails.js","name":"username","original":{"line":26,"column":24},"generated":{"line":1,"column":661}},{"source":"Functions/User/getUserDetails.js","name":"getUser","original":{"line":27,"column":8},"generated":{"line":1,"column":672}},{"source":"Functions/User/getUserDetails.js","name":"rows","original":{"line":27,"column":16},"generated":{"line":1,"column":674}},{"source":"Functions/User/getUserDetails.js","original":{"line":27,"column":21},"generated":{"line":1,"column":679}},{"source":"Functions/User/getUserDetails.js","name":"username","original":{"line":27,"column":24},"generated":{"line":1,"column":682}},{"source":"Functions/User/getUserDetails.js","original":{"line":27,"column":35},"generated":{"line":1,"column":691}},{"source":"Functions/User/getUserDetails.js","name":"getUser","original":{"line":29,"column":11},"generated":{"line":1,"column":697}},{"source":"Functions/User/getUserDetails.js","name":"rows","original":{"line":29,"column":19},"generated":{"line":1,"column":699}},{"source":"Functions/User/getUserDetails.js","original":{"line":29,"column":24},"generated":{"line":1,"column":704}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":708}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":712}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":714}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":716}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":724}},{"source":"Functions/User/getUserDetails.js","name":"getUserDetails","original":{"line":32,"column":15},"generated":{"line":1,"column":732}}],"sources":{"Functions/User/getUserDetails.js":"import db from \"../../helpers/database\";\r\n\r\n/**\r\n * Gets the user currently logged in\r\n * @param {string} token If falsy the stock user will be returned\r\n */ \r\nconst getUserDetails = async loginToken => {\r\n    let userId = 0;\r\n\r\n    const client  = await db.connect();\r\n\r\n    const loginTokenCheck = await db.query(`SELECT userid FROM \"LoginTokens\" WHERE token = $1 LIMIT 1;`, [loginToken]);\r\n\r\n    if (loginTokenCheck.rows[0])\r\n        userId = loginTokenCheck.rows[0].userid;\r\n\r\n\r\n\r\n    const getUser = await client.query(`SELECT \"Users\".id, \"Users\".username, \"Users\".token, \"Users\".roleid, \"Users\".uploadsize, \"Users\".isadmin\r\n                                        FROM \"Users\"\r\n                                        WHERE \"Users\".id = $1`, [\r\n                                            userId\r\n                                        ]);\r\n                    await client.release();\r\n\r\n    if (getUser.rows[0].username === \"null\")\r\n        getUser.rows[0].username = null\r\n    \r\n    return getUser.rows[0];\r\n};\r\n\r\nexport default getUserDetails;"},"lineCount":null}},"hash":"18b90b269bdef9bc1a2af22f9b0c1eef","cacheData":{"env":{}}}