{"id":"XsnE","dependencies":[{"name":"C:\\Users\\inaba\\Programming\\Lewd2\\.babelrc","includedInParent":true,"mtime":1545517173655},{"name":"C:\\Users\\inaba\\Programming\\Lewd2\\package.json","includedInParent":true,"mtime":1545850952595},{"name":"../../helpers/database","loc":{"line":1,"column":15},"parent":"C:\\Users\\inaba\\Programming\\Lewd2\\src\\Functions\\Transparency\\logToTransparency.js","resolved":"C:\\Users\\inaba\\Programming\\Lewd2\\src\\helpers\\database.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=void 0;var e=a(require(\"../../helpers/database\"));function a(e){return e&&e.__esModule?e:{default:e}}const t=async(a,t,r,s)=>{const n=await e.default.connect();await n.query('INSERT INTO \"Transparency\" (\"Date\", \"FileName\", \"FileHash\", \"Type\", \"Origin\")\\n                        VALUES (NOW(), $1, $2, $3, $4);',[a,t,r,s]),await n.release()};var r=t;exports.default=r;","map":{"mappings":[{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":0}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":13}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":20}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":35}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":43}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":56}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":57}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":64}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":68}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":76}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":89}},{"source":"Functions/Transparency/logToTransparency.js","original":{"line":1,"column":0},"generated":{"line":1,"column":91}},{"source":"Functions/Transparency/logToTransparency.js","original":{"line":1,"column":0},"generated":{"line":1,"column":95}},{"source":"Functions/Transparency/logToTransparency.js","original":{"line":1,"column":0},"generated":{"line":1,"column":97}},{"source":"Functions/Transparency/logToTransparency.js","original":{"line":1,"column":0},"generated":{"line":1,"column":99}},{"source":"Functions/Transparency/logToTransparency.js","original":{"line":1,"column":0},"generated":{"line":1,"column":107}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":134}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":143}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":145}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":148}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":155}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":158}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":160}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":171}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":173}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":174}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":182}},{"source":"Functions/Transparency/logToTransparency.js","original":{"line":10,"column":0},"generated":{"line":1,"column":185}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":10,"column":6},"generated":{"line":1,"column":191}},{"source":"Functions/Transparency/logToTransparency.js","original":{"line":10,"column":26},"generated":{"line":1,"column":193}},{"source":"Functions/Transparency/logToTransparency.js","name":"fileName","original":{"line":10,"column":33},"generated":{"line":1,"column":199}},{"source":"Functions/Transparency/logToTransparency.js","name":"fileHash","original":{"line":10,"column":43},"generated":{"line":1,"column":201}},{"source":"Functions/Transparency/logToTransparency.js","name":"reason","original":{"line":10,"column":53},"generated":{"line":1,"column":203}},{"source":"Functions/Transparency/logToTransparency.js","name":"origin","original":{"line":10,"column":61},"generated":{"line":1,"column":205}},{"source":"Functions/Transparency/logToTransparency.js","name":"client","original":{"line":11,"column":10},"generated":{"line":1,"column":210}},{"source":"Functions/Transparency/logToTransparency.js","name":"client","original":{"line":11,"column":10},"generated":{"line":1,"column":216}},{"source":"Functions/Transparency/logToTransparency.js","name":"db","original":{"line":11,"column":25},"generated":{"line":1,"column":224}},{"source":"Functions/Transparency/logToTransparency.js","name":"connect","original":{"line":11,"column":28},"generated":{"line":1,"column":226}},{"source":"Functions/Transparency/logToTransparency.js","name":"connect","original":{"line":11,"column":28},"generated":{"line":1,"column":234}},{"source":"Functions/Transparency/logToTransparency.js","name":"client","original":{"line":12,"column":10},"generated":{"line":1,"column":250}},{"source":"Functions/Transparency/logToTransparency.js","name":"query","original":{"line":12,"column":17},"generated":{"line":1,"column":252}},{"source":"Functions/Transparency/logToTransparency.js","original":{"line":12,"column":24},"generated":{"line":1,"column":258}},{"source":"Functions/Transparency/logToTransparency.js","original":{"line":13,"column":58},"generated":{"line":1,"column":395}},{"source":"Functions/Transparency/logToTransparency.js","name":"fileName","original":{"line":14,"column":28},"generated":{"line":1,"column":396}},{"source":"Functions/Transparency/logToTransparency.js","name":"fileHash","original":{"line":14,"column":38},"generated":{"line":1,"column":398}},{"source":"Functions/Transparency/logToTransparency.js","name":"reason","original":{"line":14,"column":48},"generated":{"line":1,"column":400}},{"source":"Functions/Transparency/logToTransparency.js","name":"origin","original":{"line":14,"column":56},"generated":{"line":1,"column":402}},{"source":"Functions/Transparency/logToTransparency.js","name":"client","original":{"line":16,"column":10},"generated":{"line":1,"column":412}},{"source":"Functions/Transparency/logToTransparency.js","name":"release","original":{"line":16,"column":17},"generated":{"line":1,"column":414}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":425}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":429}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":431}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":433}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":441}},{"source":"Functions/Transparency/logToTransparency.js","name":"logToTransparency","original":{"line":19,"column":15},"generated":{"line":1,"column":449}}],"sources":{"Functions/Transparency/logToTransparency.js":"import db from \"../../helpers/database\";\r\n\r\n/**\r\n * In case the antivirus catches something, use this to log the caught stuff\r\n * @param {string} fileName - The (original) name of the file removed\r\n * @param {string} fileHash - The hash of the file removed\r\n * @param {string} type     - The given reason behind the removal (or VirusTotal link)\r\n * @param {string} origin   - Weather the block reason comes from Google, VirusTotal, or Sophos\r\n */\r\nconst logToTransparency = async (fileName, fileHash, reason, origin) => {\r\n    const client = await db.connect();\r\n    await client.query(`INSERT INTO \"Transparency\" (\"Date\", \"FileName\", \"FileHash\", \"Type\", \"Origin\")\r\n                        VALUES (NOW(), $1, $2, $3, $4);`, [\r\n                            fileName, fileHash, reason, origin\r\n                        ]);\r\n    await client.release();\r\n}\r\n\r\nexport default logToTransparency;"},"lineCount":null}},"hash":"ba3e7c851a1c0b1c93fb849deae6958d","cacheData":{"env":{}}}